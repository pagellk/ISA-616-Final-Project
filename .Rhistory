# Drop the 'num_semesters_up_to_now' column
IS <- IS %>%
select(-num_semesters_up_to_now)
# Identify students who have graduated and have "BA Major" in their graduation term
graduated_students <- IS |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == Term.Code.Graduated) |>
dplyr::filter(Major.1 == "IS Major" | Major.2 == "IS Major" | Major.3 == "IS Major") |>
dplyr::ungroup()
# Count the number of unique Term.Code entries for each Student.ID
semester_counts <- IS |>
dplyr::group_by(Student.ID) |>
dplyr::summarize(Semester_Count = dplyr::n_distinct(Term.Code), .groups = 'drop')
# Join the semester counts with the graduated students
graduated_students <- graduated_students |>
dplyr::inner_join(semester_counts, by = "Student.ID")
# Summarize the distribution of semester counts
distribution <- graduated_students |>
dplyr::group_by(Semester_Count) |>
dplyr::summarize(Num_Students = dplyr::n(), .groups = 'drop')
# Filter for students graduating in less than 8 semesters
distribution <- distribution |>
dplyr::filter(Semester_Count < 8)
# Calculate the total number of students
total_students <- sum(distribution$Num_Students)
# Add a percentage column
distribution <- distribution |>
dplyr::mutate(Percentage = (Num_Students / total_students) * 100)
# Display the distribution in a formatted table with a colored header
knitr::kable(distribution, col.names = c("Number of Semesters", "Number of Students", "% of Total"), caption = "Distribution of Semesters to Graduation for BA Majors") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
) |>
kableExtra::column_spec(1) |>
kableExtra::column_spec(2) |>
kableExtra::column_spec(3) |>
kableExtra::row_spec(0, background = "#ADD8E6")  # Light blue header
# Step 1: Identify students who graduated in 6 semesters
students_6_semesters <- semester_counts |>
dplyr::filter(Semester_Count == 6) |>
dplyr::select(Student.ID)
# Step 2: Get the rows from the IS dataframe for these students
students_6_semesters_data <- IS |>
dplyr::filter(Student.ID %in% students_6_semesters$Student.ID)
# Step 3: Filter for students who have "IS Major" in their final term
students_with_is_major <- students_6_semesters_data |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::filter(Major.1 == "IS Major" | Major.2 == "IS Major" | Major.3 == "IS Major") |>
dplyr::ungroup()
# Step 4: Select only the first and last row for each Student.ID (first and last semester)
graduated_students_6_semesters <- students_6_semesters_data |>
dplyr::filter(Student.ID %in% students_with_is_major$Student.ID) |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == min(Term.Code) | Term.Code == max(Term.Code)) |>
dplyr::ungroup()
# Step 5: For the first and last semester, collapse majors into a single column (one for each row)
graduated_students_6_semesters <- graduated_students_6_semesters |>
dplyr::group_by(Student.ID, Term.Code) |>
dplyr::mutate(All_Majors = paste(unique(na.omit(c(Major.1, Major.2, Major.3)[c(Major.1, Major.2, Major.3) != "None"])), collapse = ", ")) |>
dplyr::ungroup()
# Step 6: Remove duplicate rows by Student.ID and Term.Code (to avoid repeated majors for students with multiple majors)
graduated_students_6_semesters <- graduated_students_6_semesters |>
dplyr::distinct(Student.ID, Term.Code, .keep_all = TRUE) |>
dplyr::select(Student.ID, Cohort.Term, Term.Code, Cum.Credit.Hours, Cum.UG.Crs.GPA, All_Majors)
# Step 7: Filter out students who graduated in term 202510
graduated_students_6_semesters <- graduated_students_6_semesters |>
dplyr::filter(Term.Code != 202510)
# Display the distribution in a formatted table with a colored header
knitr::kable(graduated_students_6_semesters,
col.names = c("Student ID", "Cohort Term", "Term Code", "Cumulative Credit Hours", "Cumulative GPA", "Major(s)"),
caption = "Distribution of Semesters to Graduation") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
) |>
kableExtra::column_spec(1) |>
kableExtra::column_spec(2) |>
kableExtra::column_spec(3) |>
kableExtra::row_spec(0, background = "#ADD8E6")  # Light blue header
# Calculate the mean number of credit hours during the first semester
mean_first_semester_credits <- graduated_students_6_semesters |>
dplyr::filter(Term.Code == Cohort.Term) |>
dplyr::summarize(mean_credits = mean(`Cum.Credit.Hours`, na.rm = TRUE)) |>
dplyr::pull(mean_credits)
# Calculate the mean GPA at graduation
mean_graduation_gpa <- graduated_students_6_semesters |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::summarize(mean_gpa = mean(`Cum.UG.Crs.GPA`, na.rm = TRUE)) |>
dplyr::pull(mean_gpa) |>
mean(na.rm = TRUE)  # Get the overall mean across all students
# Calculate the percentage of students who graduated with more than one major
# We only want one result for the percentage, not grouped by Student.ID
percentage_more_than_one_major <- graduated_students_6_semesters |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::mutate(num_majors = stringr::str_count(All_Majors, ", ") + 1) |>
dplyr::summarize(more_than_one_major = sum(num_majors > 1)) |>
dplyr::ungroup() |>
dplyr::summarize(percentage = (sum(more_than_one_major > 0) / n()) * 100) |>
dplyr::pull(percentage)
# Create a summary table with a single row
summary_table <- tibble::tibble(
`Mean First Semester Credits` = mean_first_semester_credits,
`Mean Graduation GPA` = mean_graduation_gpa,
`Percentage with More Than One Major` = percentage_more_than_one_major
)
# Display the summary table
knitr::kable(summary_table,
caption = "Summary of Student Graduation Data") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
)
# Step 1: Identify students who graduated in 6 semesters
students_6_semesters <- semester_counts |>
dplyr::filter(Semester_Count == 6) |>
dplyr::select(Student.ID)
# Step 2: Get the rows from the IS dataframe for these students
students_6_semesters_data <- IS |>
dplyr::filter(Student.ID %in% students_6_semesters$Student.ID)
# Step 3: Filter for students who have "IS Major" in their final term
students_with_is_major <- students_6_semesters_data |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::filter(Major.1 == "IS Major" | Major.2 == "IS Major" | Major.3 == "IS Major") |>
dplyr::ungroup()
# Step 4: Select only the first and last row for each Student.ID (first and last semester)
graduated_students_6_semesters <- students_6_semesters_data |>
dplyr::filter(Student.ID %in% students_with_is_major$Student.ID) |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == min(Term.Code) | Term.Code == max(Term.Code)) |>
dplyr::ungroup()
# Step 5: For the first and last semester, collapse majors into a single column (one for each row)
graduated_students_6_semesters <- graduated_students_6_semesters |>
dplyr::group_by(Student.ID, Term.Code) |>
dplyr::mutate(All_Majors = paste(unique(na.omit(c(Major.1, Major.2, Major.3)[c(Major.1, Major.2, Major.3) != "None"])), collapse = ", ")) |>
dplyr::ungroup()
# Step 6: Remove duplicate rows by Student.ID and Term.Code (to avoid repeated majors for students with multiple majors)
graduated_students_6_semesters <- graduated_students_6_semesters |>
dplyr::distinct(Student.ID, Term.Code, .keep_all = TRUE) |>
dplyr::select(Student.ID, Cohort.Term, Term.Code, Cum.Credit.Hours, Cum.UG.Crs.GPA, All_Majors)
# Step 7: Filter out students who graduated in term 202510
graduated_students_6_semesters <- graduated_students_6_semesters |>
dplyr::filter(Term.Code != 202510)
# Step 8: Calculate the credit hours per semester
credit_hours_per_semester <- students_6_semesters_data |>
dplyr::filter(Student.ID %in% graduated_students_6_semesters$Student.ID) |>
dplyr::arrange(Student.ID, Term.Code) |>
dplyr::group_by(Student.ID) |>
dplyr::mutate(Credit_Hours_Semester = Cum.Credit.Hours - dplyr::lag(Cum.Credit.Hours, default = 0)) |>
dplyr::ungroup()
# Step 9: Calculate the aggregated average credit hours per semester
total_credit_hours <- sum(credit_hours_per_semester$Credit_Hours_Semester, na.rm = TRUE)
total_semesters <- nrow(credit_hours_per_semester)
avg_credit_hours_per_semester_aggregated <- total_credit_hours / total_semesters
# Display the aggregated average credit hours per semester
knitr::kable(data.frame(Average_Credit_Hours_Per_Semester = avg_credit_hours_per_semester_aggregated),
col.names = c("Average Credit Hours per Semester"),
caption = "Aggregated Average Credit Hours per Semester for Graduated Students") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
) |>
kableExtra::column_spec(1) |>
kableExtra::row_spec(0, background = "#ADD8E6")  # Light blue header
# Calculate the credit hours per semester for all students
credit_hours_per_semester_all <- IS |>
dplyr::arrange(Student.ID, Term.Code) |>
dplyr::group_by(Student.ID) |>
dplyr::mutate(Credit_Hours_Semester = Cum.Credit.Hours - dplyr::lag(Cum.Credit.Hours, default = 0)) |>
dplyr::ungroup()
# Calculate the aggregated average credit hours per semester for all students
total_credit_hours_all <- sum(credit_hours_per_semester_all$Credit_Hours_Semester, na.rm = TRUE)
total_semesters_all <- nrow(credit_hours_per_semester_all)
avg_credit_hours_per_semester_all <- total_credit_hours_all / total_semesters_all
# Display the aggregated average credit hours per semester for all students
knitr::kable(data.frame(Average_Credit_Hours_Per_Semester = avg_credit_hours_per_semester_all),
col.names = c("Average Credit Hours per Semester"),
caption = "Aggregated Average Credit Hours per Semester for All Students") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
) |>
kableExtra::column_spec(1) |>
kableExtra::row_spec(0, background = "#ADD8E6")  # Light blue header
# Identify students who have graduated and have "IS Major" in their graduation term
graduated_students <- IS |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == Term.Code.Graduated) |>
dplyr::filter(Major.1 == "IS Major" | Major.2 == "IS Major" | Major.3 == "IS Major") |>
dplyr::ungroup()
# Count the number of unique Term.Code entries for each Student.ID
semester_counts <- IS |>
dplyr::group_by(Student.ID) |>
dplyr::summarize(Semester_Count = dplyr::n_distinct(Term.Code), .groups = 'drop')
# Join the semester counts with the graduated students
graduated_students <- graduated_students |>
dplyr::inner_join(semester_counts, by = "Student.ID")
# Summarize the distribution of semester counts
distribution <- graduated_students |>
dplyr::group_by(Semester_Count) |>
dplyr::summarize(Num_Students = dplyr::n(), .groups = 'drop')
# Filter for students graduating in less than 8 semesters
distribution <- distribution |>
dplyr::filter(Semester_Count > 8)
# Calculate the total number of students
total_students <- sum(distribution$Num_Students)
# Add a percentage column
distribution <- distribution |>
dplyr::mutate(Percentage = (Num_Students / total_students) * 100)
# Display the distribution in a formatted table with a colored header
knitr::kable(distribution, col.names = c("Number of Semesters", "Number of Students", "% of Total"), caption = "Distribution of Semesters to Graduation for BA Majors") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
) |>
kableExtra::column_spec(1) |>
kableExtra::column_spec(2) |>
kableExtra::column_spec(3) |>
kableExtra::row_spec(0, background = "#ADD8E6")  # Light blue header
# Step 1: Identify students who graduated in 9 semesters
students_9_semesters <- semester_counts |>
dplyr::filter(Semester_Count == 9) |>
dplyr::select(Student.ID)
# Step 2: Get the rows from the IS dataframe for these students
students_9_semesters_data <- IS |>
dplyr::filter(Student.ID %in% students_9_semesters$Student.ID)
# Step 3: Filter for students who have "IS Major" in their final term
students_with_is_major <- students_9_semesters_data |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::filter(Major.1 == "IS Major" | Major.2 == "IS Major" | Major.3 == "IS Major") |>
dplyr::ungroup()
# Step 4: Select only the first and last row for each Student.ID (first and last semester)
graduated_students_9_semesters <- students_9_semesters_data |>
dplyr::filter(Student.ID %in% students_with_is_major$Student.ID) |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == min(Term.Code) | Term.Code == max(Term.Code)) |>
dplyr::ungroup()
# Step 5: For the first and last semester, collapse majors into a single column (one for each row)
graduated_students_9_semesters <- graduated_students_9_semesters |>
dplyr::group_by(Student.ID, Term.Code) |>
dplyr::mutate(All_Majors = paste(unique(na.omit(c(Major.1, Major.2, Major.3)[c(Major.1, Major.2, Major.3) != "None"])), collapse = ", ")) |>
dplyr::ungroup()
# Step 6: Remove duplicate rows by Student.ID and Term.Code (to avoid repeated majors for students with multiple majors)
graduated_students_9_semesters <- graduated_students_9_semesters |>
dplyr::distinct(Student.ID, Term.Code, .keep_all = TRUE) |>
dplyr::select(Student.ID, Cohort.Term, Term.Code, Cum.Credit.Hours, Cum.UG.Crs.GPA, All_Majors)
# Step 7: Filter out student ID 8226483
graduated_students_9_semesters <- graduated_students_9_semesters |>
dplyr::filter(Student.ID != 8226483)
# Display the distribution in a formatted table with a colored header
knitr::kable(graduated_students_9_semesters,
col.names = c("Student ID", "Cohort Term", "Term Code", "Cumulative Credit Hours", "Cumulative GPA", "Major(s)"),
caption = "Distribution of Semesters to Graduation") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
) |>
kableExtra::column_spec(1) |>
kableExtra::column_spec(2) |>
kableExtra::column_spec(3) |>
kableExtra::row_spec(0, background = "#ADD8E6")  # Light blue header
# Calculate the mean number of credit hours during the first semester
mean_first_semester_credits <- graduated_students_9_semesters |>
dplyr::filter(Term.Code == Cohort.Term) |>
dplyr::summarize(mean_credits = mean(`Cum.Credit.Hours`, na.rm = TRUE)) |>
dplyr::pull(mean_credits)
# Calculate the mean GPA at graduation
mean_graduation_gpa <- graduated_students_9_semesters |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::summarize(mean_gpa = mean(`Cum.UG.Crs.GPA`, na.rm = TRUE)) |>
dplyr::pull(mean_gpa) |>
mean(na.rm = TRUE)  # Get the overall mean across all students
# Calculate the percentage of students who graduated with more than one major
# We only want one result for the percentage, not grouped by Student.ID
percentage_more_than_one_major <- graduated_students_9_semesters |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::mutate(num_majors = stringr::str_count(All_Majors, ", ") + 1) |>
dplyr::summarize(more_than_one_major = sum(num_majors > 1)) |>
dplyr::ungroup() |>
dplyr::summarize(percentage = (sum(more_than_one_major > 0) / n()) * 100) |>
dplyr::pull(percentage)
# Create a summary table with a single row
summary_table <- tibble::tibble(
`Mean First Semester Credits` = mean_first_semester_credits,
`Mean Graduation GPA` = mean_graduation_gpa,
`Percentage with More Than One Major` = percentage_more_than_one_major
)
# Display the summary table
knitr::kable(summary_table,
caption = "Summary of Student Graduation Data") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
)
# Step 1: Identify students who graduated with a "IS Major"
students_with_is_major <- IS |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::filter(Major.1 == "IS Major" | Major.2 == "IS Major" | Major.3 == "IS Major") |>
dplyr::ungroup()
# Step 2: Calculate the average GPA for these students
average_gpa_is_major <- students_with_is_major |>
dplyr::summarize(Average_GPA = mean(Cum.UG.Crs.GPA, na.rm = TRUE))
# Display the average GPA
knitr::kable(average_gpa_is_major,
col.names = c("Average GPA"),
caption = "Average GPA for Students Graduated with BA Major") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
) |>
kableExtra::column_spec(1) |>
kableExtra::row_spec(0, background = "#ADD8E6")  # Light blue header
# Step 1: Identify students who graduated in 6 semesters
students_9_semesters <- semester_counts |>
dplyr::filter(Semester_Count == 9) |>
dplyr::select(Student.ID)
# Step 2: Get the rows from the IS dataframe for these students
students_9_semesters_data <- IS |>
dplyr::filter(Student.ID %in% students_9_semesters$Student.ID)
# Step 3: Filter for students who have "IS Major" in their final term
students_with_is_major <- students_9_semesters_data |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::filter(Major.1 == "IS Major" | Major.2 == "IS Major" | Major.3 == "IS Major") |>
dplyr::ungroup()
# Step 4: Select only the first and last row for each Student.ID (first and last semester)
graduated_students_9_semesters <- students_9_semesters_data |>
dplyr::filter(Student.ID %in% students_with_is_major$Student.ID) |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == min(Term.Code) | Term.Code == max(Term.Code)) |>
dplyr::ungroup()
# Step 5: For the first and last semester, collapse majors into a single column (one for each row)
graduated_students_9_semesters <- graduated_students_9_semesters |>
dplyr::group_by(Student.ID, Term.Code) |>
dplyr::mutate(All_Majors = paste(unique(na.omit(c(Major.1, Major.2, Major.3)[c(Major.1, Major.2, Major.3) != "None"])), collapse = ", ")) |>
dplyr::ungroup()
# Step 6: Remove duplicate rows by Student.ID and Term.Code (to avoid repeated majors for students with multiple majors)
graduated_students_9_semesters <- graduated_students_9_semesters |>
dplyr::distinct(Student.ID, Term.Code, .keep_all = TRUE) |>
dplyr::select(Student.ID, Cohort.Term, Term.Code, Cum.Credit.Hours, Cum.UG.Crs.GPA, All_Majors)
# Step 7: Filter out students who graduated in term 202510
graduated_students_9_semesters <- graduated_students_9_semesters |>
dplyr::filter(Term.Code != 202510)
# Step 8: Calculate the credit hours per semester
credit_hours_per_semester <- students_9_semesters_data |>
dplyr::filter(Student.ID %in% graduated_students_9_semesters$Student.ID) |>
dplyr::arrange(Student.ID, Term.Code) |>
dplyr::group_by(Student.ID) |>
dplyr::mutate(Credit_Hours_Semester = Cum.Credit.Hours - dplyr::lag(Cum.Credit.Hours, default = 0)) |>
dplyr::ungroup()
# Step 9: Calculate the aggregated average credit hours per semester
total_credit_hours <- sum(credit_hours_per_semester$Credit_Hours_Semester, na.rm = TRUE)
total_semesters <- nrow(credit_hours_per_semester)
avg_credit_hours_per_semester_aggregated <- total_credit_hours / total_semesters
# Display the aggregated average credit hours per semester
knitr::kable(data.frame(Average_Credit_Hours_Per_Semester = avg_credit_hours_per_semester_aggregated),
col.names = c("Average Credit Hours per Semester"),
caption = "Aggregated Average Credit Hours per Semester for Graduated Students") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
) |>
kableExtra::column_spec(1) |>
kableExtra::row_spec(0, background = "#ADD8E6")  # Light blue header
# Step 1: Identify students who graduated in 10 semesters
students_10_semesters <- semester_counts |>
dplyr::filter(Semester_Count == 10) |>
dplyr::select(Student.ID)
# Step 2: Get the rows from the IS dataframe for these students
students_10_semesters_data <- IS |>
dplyr::filter(Student.ID %in% students_10_semesters$Student.ID)
# Step 3: Filter for students who have "IS Major" in their final term
students_with_is_major <- students_10_semesters_data |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::filter(Major.1 == "IS Major" | Major.2 == "IS Major" | Major.3 == "IS Major") |>
dplyr::ungroup()
# Step 4: Select only the first and last row for each Student.ID (first and last semester)
graduated_students_10_semesters <- students_10_semesters_data |>
dplyr::filter(Student.ID %in% students_with_is_major$Student.ID) |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == min(Term.Code) | Term.Code == max(Term.Code)) |>
dplyr::ungroup()
# Step 5: For the first and last semester, collapse majors into a single column (one for each row)
graduated_students_10_semesters <- graduated_students_10_semesters |>
dplyr::group_by(Student.ID, Term.Code) |>
dplyr::mutate(All_Majors = paste(unique(na.omit(c(Major.1, Major.2, Major.3)[c(Major.1, Major.2, Major.3) != "None"])), collapse = ", ")) |>
dplyr::ungroup()
# Step 6: Remove duplicate rows by Student.ID and Term.Code (to avoid repeated majors for students with multiple majors)
graduated_students_10_semesters <- graduated_students_10_semesters |>
dplyr::distinct(Student.ID, Term.Code, .keep_all = TRUE) |>
dplyr::select(Student.ID, Cohort.Term, Term.Code, Cum.Credit.Hours, Cum.UG.Crs.GPA, All_Majors)
# Display the distribution in a formatted table with a colored header
knitr::kable(graduated_students_10_semesters,
col.names = c("Student ID", "Cohort Term", "Term Code", "Cumulative Credit Hours", "Cumulative GPA", "Major(s)"),
caption = "Distribution of Semesters to Graduation") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
) |>
kableExtra::column_spec(1) |>
kableExtra::column_spec(2) |>
kableExtra::column_spec(3) |>
kableExtra::row_spec(0, background = "#ADD8E6")  # Light blue header
# Calculate the mean number of credit hours during the first semester
mean_first_semester_credits <- graduated_students_10_semesters |>
dplyr::filter(Term.Code == Cohort.Term) |>
dplyr::summarize(mean_credits = mean(`Cum.Credit.Hours`, na.rm = TRUE)) |>
dplyr::pull(mean_credits)
# Calculate the mean GPA at graduation
mean_graduation_gpa <- graduated_students_10_semesters |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::summarize(mean_gpa = mean(`Cum.UG.Crs.GPA`, na.rm = TRUE)) |>
dplyr::pull(mean_gpa) |>
mean(na.rm = TRUE)  # Get the overall mean across all students
# Calculate the percentage of students who graduated with more than one major
# We only want one result for the percentage, not grouped by Student.ID
percentage_more_than_one_major <- graduated_students_9_semesters |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::mutate(num_majors = stringr::str_count(All_Majors, ", ") + 1) |>
dplyr::summarize(more_than_one_major = sum(num_majors > 1)) |>
dplyr::ungroup() |>
dplyr::summarize(percentage = (sum(more_than_one_major > 0) / n()) * 100) |>
dplyr::pull(percentage)
# Create a summary table with a single row
summary_table <- tibble::tibble(
`Mean First Semester Credits` = mean_first_semester_credits,
`Mean Graduation GPA` = mean_graduation_gpa,
`Percentage with More Than One Major` = percentage_more_than_one_major
)
# Display the summary table
knitr::kable(summary_table,
caption = "Summary of Student Graduation Data") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
)
# Step 1: Identify students who graduated in 10 semesters
students_10_semesters <- semester_counts |>
dplyr::filter(Semester_Count == 10) |>
dplyr::select(Student.ID)
# Step 2: Get the rows from the IS dataframe for these students
students_10_semesters_data <- IS |>
dplyr::filter(Student.ID %in% students_10_semesters$Student.ID)
# Step 3: Filter for students who have "IS Major" in their final term
students_with_is_major <- students_10_semesters_data |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == max(Term.Code)) |>
dplyr::filter(Major.1 == "IS Major" | Major.2 == "IS Major" | Major.3 == "IS Major") |>
dplyr::ungroup()
# Step 4: Select only the first and last row for each Student.ID (first and last semester)
graduated_students_10_semesters <- students_10_semesters_data |>
dplyr::filter(Student.ID %in% students_with_is_major$Student.ID) |>
dplyr::group_by(Student.ID) |>
dplyr::filter(Term.Code == min(Term.Code) | Term.Code == max(Term.Code)) |>
dplyr::ungroup()
# Step 5: For the first and last semester, collapse majors into a single column (one for each row)
graduated_students_10_semesters <- graduated_students_10_semesters |>
dplyr::group_by(Student.ID, Term.Code) |>
dplyr::mutate(All_Majors = paste(unique(na.omit(c(Major.1, Major.2, Major.3)[c(Major.1, Major.2, Major.3) != "None"])), collapse = ", ")) |>
dplyr::ungroup()
# Step 6: Remove duplicate rows by Student.ID and Term.Code (to avoid repeated majors for students with multiple majors)
graduated_students_10_semesters <- graduated_students_10_semesters |>
dplyr::distinct(Student.ID, Term.Code, .keep_all = TRUE) |>
dplyr::select(Student.ID, Cohort.Term, Term.Code, Cum.Credit.Hours, Cum.UG.Crs.GPA, All_Majors)
# Step 7: Filter out students who graduated in term 202510
graduated_students_10_semesters <- graduated_students_10_semesters |>
dplyr::filter(Term.Code != 202510)
# Step 8: Calculate the credit hours per semester
credit_hours_per_semester <- students_10_semesters_data |>
dplyr::filter(Student.ID %in% graduated_students_10_semesters$Student.ID) |>
dplyr::arrange(Student.ID, Term.Code) |>
dplyr::group_by(Student.ID) |>
dplyr::mutate(Credit_Hours_Semester = Cum.Credit.Hours - dplyr::lag(Cum.Credit.Hours, default = 0)) |>
dplyr::ungroup()
# Step 9: Calculate the aggregated average credit hours per semester
total_credit_hours <- sum(credit_hours_per_semester$Credit_Hours_Semester, na.rm = TRUE)
total_semesters <- nrow(credit_hours_per_semester)
avg_credit_hours_per_semester_aggregated <- total_credit_hours / total_semesters
# Display the aggregated average credit hours per semester
knitr::kable(data.frame(Average_Credit_Hours_Per_Semester = avg_credit_hours_per_semester_aggregated),
col.names = c("Average Credit Hours per Semester"),
caption = "Aggregated Average Credit Hours per Semester for Graduated Students") |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed"),
full_width = FALSE,
position = "center"
) |>
kableExtra::column_spec(1) |>
kableExtra::row_spec(0, background = "#ADD8E6")  # Light blue header
